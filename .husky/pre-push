#!/bin/sh
# ğŸ¤– [IA] - v1.2.4: Pre-push hook - Full validation before push
. "$(dirname "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push validation..."
echo "This will run complete test suite to ensure code quality"

# Run unit tests with Docker fallback
echo "Running unit tests..."

# ğŸ¤– [IA] - v1.2.21: Docker fallback - Use local tests if Docker unavailable
if docker info >/dev/null 2>&1; then
    # Docker available - use containerized tests (original behavior)
    ./Scripts/docker-test-commands.sh test:unit || {
        echo "âŒ Unit tests failed! Push aborted."
        exit 1
    }
else
    # Docker not available - fallback to local unit tests
    echo "ğŸ³ Docker not available, running local unit tests..."
    npm run test:unit || {
        echo "âŒ Unit tests failed! Push aborted."
        exit 1
    }
fi

echo "âœ… All pre-push checks passed! Pushing to remote..."