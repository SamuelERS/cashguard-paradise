# üìã Arquitectura T√©cnica - CashGuard Paradise PWA

## Resumen Ejecutivo: Stack Tecnol√≥gico Completo

> **Versi√≥n del Documento:** 1.0.0
> **Fecha:** 15 de Octubre 2025
> **Autor:** Paradise System Labs
> **Prop√≥sito:** Referencia t√©cnica completa para desarrollo de proyectos PWA empresariales

---

## üéØ Prop√≥sito del Proyecto

**CashGuard Paradise** es una **Progressive Web App (PWA)** profesional dise√±ada para el control de caja inteligente de Acuarios Paradise. El sistema implementa protocolos anti-fraude avanzados con verificaci√≥n ciega, generaci√≥n automatizada de reportes WhatsApp, y arquitectura multi-fase para conteo de efectivo y pagos electr√≥nicos.

### Caracter√≠sticas Principales de la PWA

- **Standalone** - Modo aplicaci√≥n nativa con experiencia mobile-first
- **Offline-first** - Service Worker con estrategia de cach√© inteligente
- **Mobile-optimized** - Responsive design, orientaci√≥n portrait prioritaria
- **Installable** - Manifest completo con iconos progresivos (16√ó16 ‚Üí 512√ó512)

---

## üèóÔ∏è Arquitectura T√©cnica - Stack Completo

### 1. Core Framework & Runtime

| Componente | Versi√≥n | Descripci√≥n |
|------------|---------|-------------|
| **Node.js** | 20 LTS | Runtime JavaScript (Alpine Linux en Docker) |
| **React** | 18.3.1 | Framework UI con hooks modernos |
| **TypeScript** | 5.8.3 | Tipado estricto (`strictNullChecks`, `noImplicitAny`) |
| **Vite** | 5.4.19 | Build tool ultra-r√°pido (HMR, optimizaci√≥n autom√°tica) |

---

### 2. PWA Capabilities

| Componente | Versi√≥n | Configuraci√≥n |
|------------|---------|---------------|
| **VitePWA Plugin** | 1.0.2 | Generaci√≥n autom√°tica manifest + Service Worker |
| **Workbox** | (integrado) | Precaching + offline routing |
| **Manifest.webmanifest** | PWA Standard | 15 iconos (48px-512px), shortcuts, edge panel support |
| **Service Worker** | ES Modules | Auto-update strategy, navegaci√≥n SPA |

#### Configuraci√≥n Destacada

```typescript
devOptions: {
  enabled: true,          // Manifest en dev mode (testing PWA completo)
  type: 'module',         // ES modules para SW
  suppressWarnings: true  // Console limpia en desarrollo
}
```

**Patrones de Cach√©:**
- `globPatterns: ['**/*.{js,css,html,ico,png,svg}']` - Assets est√°ticos
- `maximumFileSizeToCacheInBytes: 5000000` - L√≠mite 5MB por archivo
- `navigateFallback: '/'` - SPA routing offline

---

### 3. UI Framework & Design System

| Componente | Versi√≥n | Uso |
|------------|---------|-----|
| **shadcn/ui** | Latest | 30+ componentes Radix UI preconfigurados |
| **Radix UI** | 1.x-2.x | Primitivas accesibles (Dialog, Alert, Tooltip, etc.) |
| **Tailwind CSS** | 3.4.17 | Utility-first styling + responsive design |
| **Framer Motion** | 12.23.12 | Animaciones fluidas (modales, transiciones) |
| **Lucide React** | 0.462.0 | Iconos SVG optimizados (1000+ iconos) |
| **Sonner** | 2.0.7 | Toast notifications elegantes |

#### Utilidades CSS

- **`class-variance-authority`** - CVA para variantes de componentes
- **`tailwind-merge` + `clsx`** - Merge de clases din√°micas
- **`tailwindcss-animate`** - Animaciones Tailwind preconfiguradas
- **`@tailwindcss/typography`** - Contenido rich-text (art√≠culos, blogs)

---

### 4. State Management & Data

| Librer√≠a | Versi√≥n | Prop√≥sito |
|----------|---------|-----------|
| **React Hooks** | Built-in | State local (`useState`, `useReducer`, `useCallback`) |
| **TanStack Query** | 5.83.0 | Server state + caching (queries optimistas) |
| **React Hook Form** | 7.61.1 | Formularios performantes con validaci√≥n |
| **Zod** | 3.25.76 | Schema validation TypeScript-first |
| **LocalStorage** | Native API | Persistencia offline (auto-serializaci√≥n) |

---

### 5. Routing & Navigation

| Componente | Versi√≥n | Configuraci√≥n |
|------------|---------|---------------|
| **React Router DOM** | 6.30.1 | SPA routing client-side |
| **Apache .htaccess** | Integrado | Rewrite rules para servir `index.html` en todas las rutas |

#### .htaccess - Caracter√≠sticas Clave

- **HTTPS forzado** - PWA requirement (redirect 301)
- **Headers de cach√© optimizados** - Assets 1 year, HTML no-cache
- **Compresi√≥n GZIP autom√°tica** - HTML, CSS, JS, JSON
- **Security headers** - `X-Frame-Options`, `X-Content-Type-Options`, `X-XSS-Protection`

---

### 6. Testing Ecosystem

| Tool | Versi√≥n | Cobertura |
|------|---------|-----------|
| **Vitest** | 1.6.0 | Test runner ultra-r√°pido (compatible Vite) |
| **@vitest/ui** | 1.6.0 | UI interactiva para debugging |
| **@vitest/coverage-v8** | 1.6.0 | Cobertura con V8 engine (55% branches, 34% lines) |
| **@testing-library/react** | 16.0.0 | Testing componentes React |
| **@testing-library/user-event** | 14.5.2 | Simulaci√≥n interacciones usuario |
| **jsdom** | 24.1.1 | DOM simulation en Node.js |
| **fast-check** | 3.23.2 | Property-based testing (validaci√≥n matem√°tica) |
| **MSW** | 2.3.5 | Mock Service Worker (API mocking) |

#### Thresholds de Cobertura

```json
{
  "branches": 55,
  "functions": 23,
  "lines": 19,
  "statements": 19
}
```

**M√©tricas Actuales:**
- ‚úÖ 641+ tests (unit + integration + E2E)
- ‚úÖ 99.4% passing rate
- ‚úÖ Property-based testing con 10,900 validaciones autom√°ticas

---

### 7. Containerization - Docker

#### Multi-stage Dockerfile (3 Stages)

| Stage | Base Image | Prop√≥sito |
|-------|------------|-----------|
| **development** | `node:20-alpine` | Testing E2E + desarrollo local |
| **builder** | `node:20-alpine` | Build producci√≥n (Vite compile) |
| **production** | `nginx:alpine` | Servidor Nginx optimizado |

#### Seguridad en Producci√≥n

- **Usuario no-root** - `www-user:1001` (principio de menor privilegio)
- **Health check** - `/health` endpoint cada 30s
- **CA certificates** - Soporte HTTPS completo
- **Nginx hardened** - Configurado como usuario no-privilegiado

**Dockerfile - Arquitectura Multi-stage:**
```dockerfile
# Stage 1: Development
FROM node:20-alpine AS development
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
EXPOSE 5173

# Stage 2: Builder
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --silent
COPY . .
RUN npm run build

# Stage 3: Production
FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
USER www-user
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

---

### 8. CI/CD - GitHub Actions

**Workflow:** `.github/workflows/deploy-siteground.yml`

#### Pipeline Completo (7 Pasos)

1. ‚úÖ **Checkout c√≥digo** - `actions/checkout@v4`
2. ‚úÖ **Setup Node.js 20** - Con cach√© NPM (`actions/setup-node@v4`)
3. ‚úÖ **Install dependencies** - `npm ci` (reproducible clean install)
4. ‚úÖ **Build PWA producci√≥n** - `npm run build` (`NODE_ENV=production`)
5. ‚úÖ **Verificar archivos cr√≠ticos** - `manifest.webmanifest`, `sw.js`, `.htaccess`
6. ‚úÖ **Deploy FTP a SiteGround** - `SamKirkland/FTP-Deploy-Action@v4.3.5`
7. ‚úÖ **Notificaci√≥n √©xito** - Metadata (SHA, branch, actor)

#### Secrets Requeridos (GitHub Settings)

- `SITEGROUND_FTP_HOST`
- `SITEGROUND_FTP_USERNAME`
- `SITEGROUND_FTP_PASSWORD`
- `SITEGROUND_FTP_PORT`

---

### 9. Deployment Target - SiteGround

| Aspecto | Configuraci√≥n |
|---------|---------------|
| **Host** | SiteGround shared hosting |
| **Subdomain** | `cashguard.paradisesystemlabs.com` |
| **SSL** | Let's Encrypt Wildcard (`*.paradisesystemlabs.com`) |
| **FTP Path** | `cashguard.paradisesystemlabs.com/public_html/` |
| **Server** | Apache (con `.htaccess` support) |
| **Deploy Method** | Automated FTP (GitHub Actions) |

**Caracter√≠sticas del Hosting:**
- ‚úÖ SSL gratuito con renovaci√≥n autom√°tica
- ‚úÖ Apache 2.4+ con mod_rewrite habilitado
- ‚úÖ PHP 8.x disponible (no usado en PWA)
- ‚úÖ FTP/SFTP con acceso seguro
- ‚úÖ Backups autom√°ticos diarios

---

### 10. Additional Libraries

| Categor√≠a | Librer√≠a | Versi√≥n | Uso |
|-----------|----------|---------|-----|
| **Date Handling** | `date-fns` | 3.6.0 | Formateo fechas, timestamps |
| **Carousel** | `embla-carousel-react` | 8.6.0 | Sliders/carousels responsive |
| **Charts** | `recharts` | 2.15.4 | Gr√°ficos estad√≠sticos |
| **Theme** | `next-themes` | 0.3.0 | Dark/light mode |
| **OTP Input** | `input-otp` | 1.4.2 | Inputs PIN/c√≥digo |
| **Command Palette** | `cmdk` | 1.1.1 | ‚åòK command menu |
| **Resizable Panels** | `react-resizable-panels` | 2.1.9 | Paneles redimensionables |
| **Drawer** | `vaul` | 0.9.9 | Drawers mobile-friendly |

---

### 11. Development Tools

| Tool | Versi√≥n | Descripci√≥n |
|------|---------|-------------|
| **ESLint** | 9.32.0 | Linter con flat config (ESLint v9+) |
| **Husky** | 8.0.3 | Git hooks (pre-commit validations) |
| **Lovable Tagger** | 1.1.9 | Component tagging para debugging |
| **Autoprefixer** | 10.4.21 | CSS vendor prefixes autom√°ticos |
| **PostCSS** | 8.5.6 | CSS transformation pipeline |
| **typescript-eslint** | 8.38.0 | TypeScript ESLint rules |

#### ESLint Plugins

- **`eslint-plugin-react-hooks`** - 5.2.0 - Validaci√≥n hooks rules
- **`eslint-plugin-react-refresh`** - 0.4.20 - HMR optimization

---

## üì¶ Package.json - Scripts Principales

### Desarrollo

```bash
npm run dev              # Dev server (Vite) puerto 5173
npm run preview          # Preview build local
```

### Build

```bash
npm run build            # Build producci√≥n
npm run build:dev        # Build modo desarrollo (debugging)
```

### Testing

```bash
npm run test             # Tests con watch mode
npm run test:coverage    # Coverage report completo
npm run test:unit        # Solo unit tests
npm run test:integration # Solo integration tests
npm run test:e2e         # Playwright E2E tests
```

### Docker

```bash
npm run docker:test       # Tests en contenedor Docker
npm run docker:test:build # Build + tests Docker
```

### Code Quality

```bash
npm run lint             # ESLint check
npm run prepare          # Husky setup (auto-ejecuta post-install)
```

---

## üéØ Caracter√≠sticas T√©cnicas Destacadas

### ‚úÖ PWA Completa

- ‚úÖ **Offline-first** - Service Worker con cach√© inteligente
- ‚úÖ **Installable** - Manifest completo con shortcuts
- ‚úÖ **Responsive** - Mobile-first, orientaci√≥n portrait
- ‚úÖ **HTTPS obligatorio** - SSL Let's Encrypt wildcard

### ‚úÖ TypeScript Strict

- ‚úÖ **`noImplicitAny: true`** - Zero tipos impl√≠citos
- ‚úÖ **`strictNullChecks: true`** - Null safety completa
- ‚úÖ **Zero `any` types** - Codebase 100% tipado

### ‚úÖ Testing Robusto

- ‚úÖ **641+ tests** - Unit + integration + E2E
- ‚úÖ **Property-based testing** - Fast-check con 10,900 validaciones
- ‚úÖ **Coverage > 55%** - Branches, > 34% lines
- ‚úÖ **CI/CD validation** - GitHub Actions pipeline verde

### ‚úÖ Deployment Automatizado

- ‚úÖ **Push a `main`** ‚Üí Auto-deploy a SiteGround
- ‚úÖ **Verificaci√≥n archivos PWA** - Gate cr√≠tico pre-deploy
- ‚úÖ **FTP optimizado** - Exclude node_modules, .git

### ‚úÖ Security & Performance

- ‚úÖ **Docker multi-stage** - Usuario no-root en production
- ‚úÖ **Health checks** - Nginx cada 30s
- ‚úÖ **`.htaccess` optimizado** - GZIP, cach√©, security headers
- ‚úÖ **Bundle optimization** - Vite tree-shaking, code-splitting

---

## üìä Bundle Size (Producci√≥n)

| Asset | Size | Gzip |
|-------|------|------|
| **JavaScript** | ~1.44 MB | ~335 KB |
| **CSS** | ~50 KB | ~12 KB |
| **Total** | ~1.49 MB | ~347 KB |

### Optimizaciones Aplicadas

- ‚úÖ **Tree-shaking autom√°tico** - Vite elimina c√≥digo no usado
- ‚úÖ **Code-splitting por rutas** - Lazy loading de componentes
- ‚úÖ **Assets con hashing** - Cache invalidation autom√°tica (1 year)
- ‚úÖ **Service Worker precache selectivo** - Solo assets cr√≠ticos

---

## üîí Requirements del Sistema

| Componente | Versi√≥n M√≠nima |
|------------|----------------|
| **Node.js** | 20 LTS |
| **npm** | 10+ |
| **Docker** | 20+ (opcional, para testing) |
| **Git** | 2.30+ |
| **OS** | macOS / Linux / Windows (WSL2) |

---

## üìû Contacto T√©cnico

- **Proyecto:** CashGuard Paradise
- **Versi√≥n:** 2.7.0
- **Repositorio:** [GitHub](https://github.com/SamuelERS/cashguard-paradise)
- **URL Producci√≥n:** [https://cashguard.paradisesystemlabs.com](https://cashguard.paradisesystemlabs.com)
- **Documentaci√≥n:** [TECHNICAL-SPECS.md](/Documentos_MarkDown/TECHNICAL-SPECS.md)

---

## ‚úÖ Conclusi√≥n

Este stack tecnol√≥gico es **100% reutilizable** para nuevos proyectos PWA empresariales. Todos los componentes son:

- ‚úÖ **Modernos** - Versiones LTS/Latest con soporte activo
- ‚úÖ **Probados** - 641+ tests passing, CI/CD pipeline verde
- ‚úÖ **Documentados** - CLAUDE.md, TECHNICAL-SPECS.md exhaustivos
- ‚úÖ **Escalables** - Docker, GitHub Actions, hosting flexible
- ‚úÖ **Seguros** - TypeScript strict, ESLint, usuario no-root

### Pr√≥ximos Pasos para Clonar el Stack

1. **Clonar repositorio base** - Eliminar l√≥gica de negocio espec√≠fica
2. **Actualizar manifest.webmanifest** - Nombre, descripci√≥n, iconos personalizados
3. **Configurar secrets GitHub** - FTP credentials de hosting destino
4. **Adaptar `.htaccess`** - Ajustar security headers seg√∫n necesidad
5. **Deploy inicial** - Validar pipeline completo funciona

**Tiempo estimado:** 2-3 horas para nuevo proyecto desde este stack.

---

**√öltima actualizaci√≥n:** 15 de Octubre 2025
**Versi√≥n del documento:** 1.0.0
**Mantenido por:** Paradise System Labs
